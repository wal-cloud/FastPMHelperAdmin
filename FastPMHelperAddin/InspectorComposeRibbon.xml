<?xml version="1.0" encoding="UTF-8"?>
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" onLoad="Ribbon_Load">
  <ribbon>
    <tabs>
      <tab idMso="TabNewMailMessage">
        <group id="ActionTrackingGroup" label="Actions">

          <!-- Stack everything vertically -->
          <box id="mainBox" boxStyle="vertical">

            <!-- Row 1: Create actions -->
            <box id="createBox" boxStyle="horizontal">
              <toggleButton
                id="btnCreateAction"
                label="Create"
                size="normal"
                showImage="false"
                getPressed="GetCreateActionPressed"
                onAction="OnCreateActionToggle" />

              <toggleButton
                id="btnCreateMultipleAction"
                label="Create Multiple"
                size="normal"
                showImage="false"
                getPressed="GetCreateMultipleActionPressed"
                onAction="OnCreateMultipleActionToggle" />
            </box>

            <!-- Row 2: Update/Close/Reopen - aligned with row 1 -->
            <box id="updateBox" boxStyle="horizontal">
              <toggleButton
                id="btnUpdateAction"
                label="Update"
                size="normal"
                showImage="false"
                getPressed="GetUpdateActionPressed"
                onAction="OnUpdateActionToggle" />

              <toggleButton
                id="btnCloseAction"
                label="Close"
                size="normal"
                showImage="false"
                getPressed="GetCloseActionPressed"
                onAction="OnCloseActionToggle" />

              <toggleButton
                id="btnReopenAction"
                label="Reopen"
                size="normal"
                showImage="false"
                getPressed="GetReopenActionPressed"
                onAction="OnReopenActionToggle" />
            </box>

            <!-- Row 3: Dropdown -->
            <dropDown id="ddActionSelector"
                      sizeString="WWWWWWWWWWWWWWWWWWWW"
                      getItemCount="GetActionCount"
                      getItemLabel="GetActionLabel"
                      getItemID="GetActionID"
                      getSelectedItemIndex="GetSelectedActionIndex"
                      onAction="OnActionSelected" />

          </box>

          <!-- Status label - commented out but available for debugging
          <labelControl
            id="lblStatus"
            getLabel="GetStatusLabel" />
          -->

        </group>
      </tab>
    </tabs>
  </ribbon>
</customUI>
